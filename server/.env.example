# File: server/.env.example

# --- REPLACE START: canonical dev template (keeps legacy keys; adds CORS keys + Checkout/Portal URLs + mock switch) ---

# MongoDB (local dev). Note: INITDB vars are only used by dockerized Mongo, safe to keep here.
MONGO_INITDB_ROOT_USERNAME=admin
MONGO_INITDB_ROOT_PASSWORD=secret
MONGO_URI=mongodb://127.0.0.1:27017/loventia

# App environment
NODE_ENV=development
PORT=5000

# JWT secrets (replace in your local .env; do NOT commit real secrets)
JWT_SECRET=change-me
JWT_REFRESH_SECRET=change-me-refresh

# ───────────────────────────────────────────────────────────────────────────────
# CORS / Client origins
# - CLIENT_URL: local dev client (Vite default 5174)
# - STAGE_CLIENT_URL / PROD_CLIENT_URL: set when you have staging/prod frontends
# - CORS_EXTRA_ORIGINS: optional, comma-separated list for additional allowed origins
#   Examples:
#     CORS_EXTRA_ORIGINS=https://preview.example.com,https://admin.example.com
# - NOTE: The server also accepts CORS_ORIGINS as an alias for compatibility.
# ───────────────────────────────────────────────────────────────────────────────
CLIENT_URL=http://localhost:5174
STAGE_CLIENT_URL=
PROD_CLIENT_URL=
CORS_EXTRA_ORIGINS=
# (compat alias)
CORS_ORIGINS=

# API docs (enable in dev, disable in prod unless explicitly needed)
ENABLE_API_DOCS=true

# ───────────────────────────────────────────────────────────────────────────────
# Stripe (test placeholders)
# - Keep BOTH STRIPE_PRICE_ID and STRIPE_PREMIUM_PRICE_ID for backward compatibility.
# - Webhook secret is required for /payment/stripe-webhook signature verification.
# - Success/Cancel/Return URLs: server uses these to redirect back to the client.
# - STRIPE_MOCK_MODE=1 allows local E2E tests to short-circuit checkout/portal flows.
# ───────────────────────────────────────────────────────────────────────────────
STRIPE_SECRET_KEY=sk_test_change_me
STRIPE_WEBHOOK_SECRET=whsec_change_me

# Preferred (new)
STRIPE_PRICE_ID=price_change_me
# Legacy fallback (kept so older code keeps working)
STRIPE_PREMIUM_PRICE_ID=price_change_me

# Checkout success/cancel redirect targets (override defaults from code if needed)
# Example dev defaults used by the app: http://localhost:5174/settings/subscriptions?status=success|cancel
CHECKOUT_SUCCESS_URL=http://localhost:5174/settings/subscriptions?status=success
CHECKOUT_CANCEL_URL=http://localhost:5174/settings/subscriptions?status=cancel

# Billing Portal return URL (when user exits Stripe portal)
BILLING_RETURN_URL=http://localhost:5174/settings/subscriptions

# Enable mocked billing flows for local development / Cypress E2E (1=on, 0=off)
STRIPE_MOCK_MODE=1

# ───────────────────────────────────────────────────────────────────────────────
# PayPal (optional in dev)
# ───────────────────────────────────────────────────────────────────────────────
PAYPAL_CLIENT_ID=dev-client-id
PAYPAL_SECRET=dev-secret
PAYPAL_PREMIUM_PRICE=12.00
PAYPAL_WEBHOOK_ID=dev-webhook-id

# SMTP (MailDev default)
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASS=
MAIL_FROM_NAME=MyApp

# Notifications (optional; leave empty by default)
SLACK_WEBHOOK_URL=
EMAIL_HOST=
EMAIL_PORT=
EMAIL_USER=
EMAIL_PASS=
# Use a single properly formatted value:
ALERT_EMAIL_FROM="MyApp Alerts <no-reply@example.com>"
ALERT_EMAIL_TO="team@example.com,ops@example.com"

# Thresholds for alertRules.js (dev-friendly)
ERROR_RATE_THRESHOLD=50
LATENCY_THRESHOLD_MS=100
THROUGHPUT_THRESHOLD_RPM=1

# Feature flags (dev)
ALLOW_FREE_INTROS=true

# --- REPLACE END ---

# --- REPLACE START: observability envs ---
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1
LOG_LEVEL=info
# --- REPLACE END ---

# Test helpers (used by local scripts/E2E; CI may inject secrets separately)
E2E_TEST_PASSWORD=<set-in-env>

# Token lifetimes (match server defaults)
ACCESS_TOKEN_EXPIRES=2h
REFRESH_TOKEN_EXPIRES=30d



